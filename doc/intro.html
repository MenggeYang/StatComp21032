<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Mengge Yang" />

<meta name="date" content="2021-12-20" />

<title>Introduction to StatComp21032</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Introduction to StatComp21032</h1>
<h4 class="author">Mengge Yang</h4>
<h4 class="date">2021-12-20</h4>



<div id="hw0-2021-09-16" class="section level2">
<h2>HW0 2021-09-16</h2>
</div>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce at least 3 examples(texts,figures,tables)</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>example1 生成10个服从U(0,1)的随机数</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">10</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(x)</span></code></pre></div>
<pre><code>##  [1]  0.156714443  0.394974604  0.599455202  0.433813206 -0.167084493
##  [6] -0.442405591 -1.927493771 -1.512947659 -1.777934137  0.002553543</code></pre>
<p>example2 生成U(0,1),U(0,2)和U(0,0.5)的概率密度函数</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="at">length.out=</span><span class="dv">100</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,<span class="fu">dnorm</span>(x,<span class="dv">0</span>,<span class="fl">0.5</span>),<span class="at">type=</span><span class="st">&#39;l&#39;</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,<span class="fu">dnorm</span>(x,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,<span class="fu">dnorm</span>(x,<span class="dv">0</span>,<span class="dv">2</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>example3</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>num <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>name <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;张三&#39;</span>,<span class="st">&#39;李四&#39;</span>,<span class="st">&#39;王五&#39;</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>sex <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;女&#39;</span>,<span class="st">&#39;男&#39;</span>,<span class="st">&#39;女&#39;</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(num,name,sex);x</span></code></pre></div>
<pre><code>##   num name sex
## 1   1 张三  女
## 2   2 李四  男
## 3   3 王五  女</code></pre>
</div>
<div id="hw1-2021-09-23" class="section level2">
<h2>HW1 2021-09-23</h2>
<p>3.4</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1000</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> sigma<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> u))</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main=</span><span class="fu">expression</span>(<span class="st">&quot;f(x)==x/(sigma^2)*exp(-x^2/(2*(sigma^2)))&quot;</span>))</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10000</span>, <span class="fl">0.01</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y, y<span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>3.11 有双峰，当r=0.5左右应该最为明显</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>Z <span class="ot">&lt;-</span> r <span class="sc">*</span> X1 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> r) <span class="sc">*</span> X2</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Z)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.75</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fl">0.3</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> <span class="fl">0.4</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>p6 <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>p7 <span class="ot">&lt;-</span> <span class="fl">0.6</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>p8 <span class="ot">&lt;-</span> <span class="fl">0.7</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>p9 <span class="ot">&lt;-</span> <span class="fl">0.8</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>p10 <span class="ot">&lt;-</span> <span class="fl">0.9</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>Z1 <span class="ot">&lt;-</span> p1 <span class="sc">*</span> X1 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> p1) <span class="sc">*</span> X2</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>Z2 <span class="ot">&lt;-</span> p2 <span class="sc">*</span> X1 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> p2) <span class="sc">*</span> X2</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>Z3 <span class="ot">&lt;-</span> p3 <span class="sc">*</span> X1 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> p3) <span class="sc">*</span> X2</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>Z4 <span class="ot">&lt;-</span> p4 <span class="sc">*</span> X1 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> p4) <span class="sc">*</span> X2</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>Z5 <span class="ot">&lt;-</span> p5 <span class="sc">*</span> X1 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> p5) <span class="sc">*</span> X2</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>Z6 <span class="ot">&lt;-</span> p6 <span class="sc">*</span> X1 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> p6) <span class="sc">*</span> X2</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>Z7 <span class="ot">&lt;-</span> p7 <span class="sc">*</span> X1 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> p7) <span class="sc">*</span> X2</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>Z8 <span class="ot">&lt;-</span> p8 <span class="sc">*</span> X1 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> p8) <span class="sc">*</span> X2</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>Z9 <span class="ot">&lt;-</span> p9 <span class="sc">*</span> X1 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> p9) <span class="sc">*</span> X2</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>Z10 <span class="ot">&lt;-</span> p10 <span class="sc">*</span> X1 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> p10) <span class="sc">*</span> X2</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Z1); <span class="fu">hist</span>(Z2); <span class="fu">hist</span>(Z3); <span class="fu">hist</span>(Z4); <span class="fu">hist</span>(Z5); <span class="fu">hist</span>(Z6); <span class="fu">hist</span>(Z7); <span class="fu">hist</span>(Z8); <span class="fu">hist</span>(Z9); <span class="fu">hist</span>(Z10)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>3.20 不妨设泊松分布中拉姆达为2，伽马分布的参数为（1，2） 第一个思路： (经计算可得，x(10)的均值和方差均为1)</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n, <span class="dv">2</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n, <span class="dv">1</span><span class="sc">*</span>p, <span class="dv">2</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 以上为随机生成n个复合分布的数字</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co">#下计算x(10)</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n, <span class="dv">10</span><span class="sc">*</span><span class="dv">2</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n, q<span class="sc">*</span><span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(x))</span></code></pre></div>
<pre><code>## [1] 1.032487</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">var</span>(x))</span></code></pre></div>
<pre><code>## [1] 1.14796</code></pre>
<p>第二个思路： 共生成n个数，对于每一个数，均为i（i服从泊松分布）个服从伽马分布的数相加得到（只是一些思路）</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>)){</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="fu">rpois</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">#print(j)</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    y[j] <span class="ot">&lt;-</span> <span class="fu">sum</span>(x)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">#print(sum(x))</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(y))</span></code></pre></div>
<pre><code>## [1] 0.9784084</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">var</span>(y))</span></code></pre></div>
<pre><code>## [1] 1.000154</code></pre>
</div>
<div id="hw2-2021-09-30" class="section level2">
<h2>HW2 2021-09-30</h2>
<p>##Question Exercises 5.4 5.9 5.13 and 5.14(Statistical Computating with R)</p>
<p>##Answer 5.4</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>fx <span class="ot">&lt;-</span> <span class="cf">function</span>(i){</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">runif</span>(m,<span class="dv">0</span>,i)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  theta <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="dv">30</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>i)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">c</span>(i,theta,<span class="fu">pbeta</span>(i,<span class="dv">3</span>,<span class="dv">3</span>)))</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>)){</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fx</span>(j)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 0.100000000 0.008564282 0.008560000
## [1] 0.20000000 0.05860267 0.05792000
## [1] 0.3000000 0.1647658 0.1630800
## [1] 0.400000 0.315687 0.317440
## [1] 0.5000000 0.4935499 0.5000000
## [1] 0.6000000 0.6726999 0.6825600
## [1] 0.7000000 0.8412423 0.8369200
## [1] 0.8000000 0.9471443 0.9420800
## [1] 0.9000000 0.9909803 0.9914400</code></pre>
<p>通过结果可以看出，蒙特卡洛估计十分接近真实值</p>
<p>5.9</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>fx <span class="ot">&lt;-</span> <span class="cf">function</span>(x,<span class="at">r=</span><span class="dv">1000</span>,<span class="at">antithetic=</span><span class="cn">TRUE</span>){</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(r<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span> antithetic) v <span class="ot">&lt;-</span> <span class="fu">runif</span>(r<span class="sc">/</span><span class="dv">2</span>) <span class="cf">else</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    v <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>u</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">c</span>(u,v)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  cdf <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(x))</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)){</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    g <span class="ot">&lt;-</span> x[i]<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>u<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(x[i]<span class="sc">*</span>u)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    cdf[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(g)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  cdf</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">100</span>,<span class="dv">20</span>)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>fx1 <span class="ot">&lt;-</span> <span class="fu">fx</span>(x,<span class="at">antithetic=</span><span class="cn">FALSE</span>)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>fx2 <span class="ot">&lt;-</span> <span class="fu">fx</span>(x,<span class="at">antithetic=</span><span class="cn">TRUE</span>)</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">rbind</span>(x,fx1,fx2),<span class="dv">5</span>))</span></code></pre></div>
<pre><code>##        [,1]     [,2]     [,3]     [,4]     [,5]
## x   1.00000 21.00000 41.00000 61.00000 81.00000
## fx1 0.39218  0.99374  0.94624  0.92146  0.94553
## fx2 0.39488  0.89708  0.93788  0.95188  0.95559</code></pre>
<p>此题选取sigma为1，故g(x)在代码中直接体现带入sigma的方程式。fx1为真实值，fx2为模拟值，选择(1,21,41,61,81)，可以看出模拟效果十分良好</p>
<p>5.13</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi) <span class="sc">*</span> (x <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>hat <span class="ot">&lt;-</span> se <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, <span class="dv">1</span>)<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">/</span> <span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>x)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>hat[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>se[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n,<span class="dv">2</span>,<span class="dv">2</span>)<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">/</span> (<span class="dv">4</span><span class="sc">*</span>(x<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>(x<span class="dv">-1</span>)))</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>hat[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>se[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg)</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(hat, se)</span></code></pre></div>
<pre><code>##          [,1]      [,2]
## hat 0.4006231 0.4061504
## se  0.1591802 0.3056843</code></pre>
<p>第一个密度函数为exp(1-x) 第二个密度函数为gamma(2,2)向右平移一个单位 (平移原因是原题对f(x)的定义域有要求)</p>
<p>第一个密度函数的方差更小(经过多次运行可得)</p>
<p>5.14</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi) <span class="sc">*</span> (x <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, <span class="dv">1</span>)<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">/</span> <span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>x)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(hat)</span></code></pre></div>
<pre><code>## [1] 0.4004709</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(se)</span></code></pre></div>
<pre><code>## [1] 0.1584613</code></pre>
<p>所选取f(x)为参数为1的指数分布，可以看出，重要性抽样的模拟效果良好</p>
</div>
<div id="hw3-2021-10-14" class="section level2">
<h2>HW3 2021-10-14</h2>
</div>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>Exercises 6.5 and 6.A(page 180-181)</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<p>6.5</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#设置一些必要参数</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>UCL <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">1000</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 正态分布的部分</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">2</span>)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  UCL[i] <span class="ot">&lt;-</span> (n<span class="dv">-1</span>) <span class="sc">*</span> <span class="fu">var</span>(x) <span class="sc">/</span> <span class="fu">qchisq</span>(alpha, <span class="at">df=</span>n<span class="dv">-1</span>)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>P[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(UCL <span class="sc">&gt;</span> <span class="dv">4</span>)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 卡方分布的部分</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n, <span class="at">df=</span><span class="dv">2</span>)</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>  UCL[i] <span class="ot">&lt;-</span> (<span class="fu">mean</span>(x)<span class="sc">-</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">sqrt</span>(n)<span class="sc">/</span><span class="fu">sd</span>(x)</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>P[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(UCL) <span class="sc">&lt;</span> <span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha,n<span class="dv">-1</span>))</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 输出表格</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(P,<span class="at">row.names=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;chisq&quot;</span>))</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(d)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">P</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">norm</td>
<td align="right">0.954</td>
</tr>
<tr class="even">
<td align="left">chisq</td>
<td align="right">0.879</td>
</tr>
</tbody>
</table>
<p>6.A</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 卡方(1)</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>mu0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n, <span class="dv">1</span>)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  ttest <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="at">mu =</span> mu0)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  p[j] <span class="ot">&lt;-</span> ttest<span class="sc">$</span>p.value</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>p.hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(p <span class="sc">&lt;</span> alpha)</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>se.hat <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p.hat <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p.hat) <span class="sc">/</span> m)</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(p.hat, se.hat))</span></code></pre></div>
<pre><code>## [1] 0.109000000 0.009854897</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># U(0,2)</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  ttest <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="at">mu =</span> mu0)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  p[j] <span class="ot">&lt;-</span> ttest<span class="sc">$</span>p.value</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>p.hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(p <span class="sc">&lt;</span> alpha)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>se.hat <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p.hat <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p.hat) <span class="sc">/</span> m)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(p.hat, se.hat))</span></code></pre></div>
<pre><code>## [1] 0.049000000 0.006826346</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 指数(1)</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, <span class="dv">1</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  ttest <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="at">mu =</span> mu0)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  p[j] <span class="ot">&lt;-</span> ttest<span class="sc">$</span>p.value</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>p.hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(p <span class="sc">&lt;</span> alpha)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>se.hat <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p.hat <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p.hat) <span class="sc">/</span> m)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(p.hat, se.hat))</span></code></pre></div>
<pre><code>## [1] 0.07800000 0.00848033</code></pre>
<p>讨论题：</p>
<p>(1)原假设：p1=p2 备择假设：p1!=p2 (2)在大样本情况下，使用配对样本的t检验(paired-test)/z-test。因为两种方法的样本是同一个，不独立，所以不可以使用two-sample t-test。而McNemar test是针对独立性的，验证两者是否相关，在此处不适用。 (3)需要知道样本个数n(已知),p的实际值(已知),p-value(未知)。所以知道p-value即p的理论值即可。 ## HW4 2021-10-21 ## Question Exercises 6.C(pages 182, Statistical Computating with R)</p>
<p>6.C Repeat Examples 6.8 and 6.10 for Mardia’s multivariate skewness test. Mardia proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis. If X and Y are iid, the multivariate population skewness <span class="math inline">\(\beta_{1,d}\)</span>is defined by Mardia as <span class="math display">\[\beta_{1,d}=E[(X-\mu)^T\Sigma^{-1}(Y-\mu)]^3\]</span> Under normality, <span class="math inline">\(\beta_{1,d}=0\)</span>. The multivariate skewness statistic is <span class="math display">\[b_{1,d}=\frac{1}{n^2}\sum_{i,j=1}^n((X_i-\bar{X})^T(\hat{\Sigma})^{-1}(X_j-\bar{X}))^3\]</span> where <span class="math inline">\(Sigma\)</span> is the maximum likelihood estimator of covariance. Large values of <span class="math inline">\(b_{1,d}\)</span> are significant. The asymptotic distribution of <span class="math inline">\(\frac{nb_{1,d}}{6}\)</span> is chisquared with <span class="math inline">\(\frac{d(d+1)(d+2)}{6}\)</span> degrees of freedom.</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<p>This is a multivariate skewness test of 6.8.We generate variables following <span class="math inline">\(N(\mu,\Sigma)\)</span>,where: <span class="math display">\[\mu=(0,0)^T,\Sigma=\begin{pmatrix} 1 &amp; 0 \\ 0 &amp; 1 \end{pmatrix}\]</span></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS) <span class="co"># 调用此包用于产生多元正态分布的随机数</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>func <span class="ot">&lt;-</span> <span class="cf">function</span>(data){</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data) <span class="co">#数据的行数</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  c <span class="ot">&lt;-</span> <span class="fu">ncol</span>(data) <span class="co">#数据的列数</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  central <span class="ot">&lt;-</span> data <span class="co">#数据本身，以方便下做变换</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>c){</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    central[,i] <span class="ot">&lt;-</span> data[,i]<span class="sc">-</span><span class="fu">mean</span>(data[,i]) <span class="co">#对原数据进行变体</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  sigma <span class="ot">&lt;-</span> <span class="fu">t</span>(central)<span class="sc">%*%</span>central<span class="sc">/</span>n <span class="co">#计算统计量1/4</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> central<span class="sc">%*%</span><span class="fu">solve</span>(sigma)<span class="sc">%*%</span><span class="fu">t</span>(central) <span class="co">#计算统计量2/4</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">colSums</span>(a<span class="sc">^</span><span class="dv">3</span>))<span class="sc">/</span>(n<span class="sc">^</span><span class="dv">2</span>) <span class="co">#计算统计量3/4</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  test <span class="ot">&lt;-</span> n<span class="sc">*</span>b<span class="sc">/</span><span class="dv">6</span> <span class="co">#计算统计量4/4</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  chi <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(<span class="fl">0.95</span>, c<span class="sc">*</span>(c<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(c<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span>) <span class="co">#边界值</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.integer</span>(test<span class="sc">&gt;</span>chi) <span class="co">#比较</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>) <span class="co">#均值向量</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">2</span>) <span class="co">#方差矩阵</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co">#运行次数</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">200</span>,<span class="dv">300</span>,<span class="dv">400</span>,<span class="dv">500</span>) <span class="co">#不同的样本量</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(n)) <span class="co">#长度为9</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)){</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>  a[i] <span class="ot">=</span> <span class="fu">mean</span>(<span class="fu">replicate</span>(m, <span class="at">expr=</span>{</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n[i],mu,sigma)</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">func</span>(data)</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>  }))</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(a)</span></code></pre></div>
<pre><code>## [1] 0.00 0.02 0.03 0.03 0.06 0.08 0.05 0.04 0.05</code></pre>
<p>From the result we can see that when n&gt;50,the a value is close to 0.05.</p>
<p>Next we estimate by simulation the power of the skewness test of normality against a contaminated normal (normal scale mixture) alternative,The contaminated normal distribution is denoted by <span class="math inline">\((1-\epsilon)N(\mu_1,\Sigma_1)+\epsilon N(\mu_2,\Sigma_2)\)</span>,where: <span class="math display">\[\mu_1=\mu_2=(0,0)^T,\Sigma_1=\begin{pmatrix} 1 &amp; 0 \\ 0 &amp; 1 \end{pmatrix},\Sigma_2=\begin{pmatrix} 100 &amp; 0 \\ 0 &amp; 100 \end{pmatrix}\]</span></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> mu2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">100</span>),<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">list</span>(sigma1,sigma2)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">0.1</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="fl">0.05</span>))</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">length</span>(epsilon)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>pwr <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  e <span class="ot">&lt;-</span> epsilon[j]</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>  sktests <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    index<span class="ot">=</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">replace=</span><span class="cn">TRUE</span>,<span class="at">size=</span>n,<span class="at">prob=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>e,e))</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span>n,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(index[t]<span class="sc">==</span><span class="dv">1</span>) data[t,]<span class="ot">=</span><span class="fu">mvrnorm</span>(<span class="dv">1</span>,mu1,sigma1)</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span> data[t,]<span class="ot">=</span><span class="fu">mvrnorm</span>(<span class="dv">1</span>,mu2,sigma2)</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>    sktests[i] <span class="ot">&lt;-</span> <span class="fu">func</span>(data)</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>  pwr[j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(sktests)</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(epsilon,pwr,<span class="at">type =</span> <span class="st">&#39;b&#39;</span>, <span class="at">xlab =</span> <span class="fu">bquote</span>(epsilon), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">0.01</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(pwr <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> pwr) <span class="sc">/</span> m)</span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(epsilon, pwr<span class="sc">+</span>se, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(epsilon, pwr<span class="sc">-</span>se, <span class="at">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> If <span class="math inline">\(\epsilon\)</span>=0/1,this is similar with the first situation.When <span class="math inline">\(0&lt;=\epsilon&lt;=1\)</span>, the pwr is greater than 0.05.</p>
</div>
<div id="hw5-2021-10-28" class="section level2">
<h2>HW5 2021-10-28</h2>
</div>
<div id="question-2" class="section level2">
<h2>Question</h2>
<p>Exercises 7.7,7.8,7.9 and 7.B(pages 213, Statistical Computating with R)</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<p>7.7 Refer to Exercise 7.6. Efron and Tibshirani discuss the following example.The five-dimensional scores data have a 5*5 covariance matrix <span class="math inline">\(\Sigma\)</span>, with positive eigenvalues <span class="math inline">\(\lambda_1&gt;\lambda_2&gt;\lambda_3&gt;\lambda_4&gt;\lambda_5\)</span>, In principal components analysis,<span class="math display">\[\theta=\frac{\lambda_1}{\sum_{j=1}^{5}\lambda_j}\]</span> measures the proportion of variance explained by the first principal compo- nent. Let <span class="math inline">\(\hat\lambda_1&gt;\hat\lambda_2&gt;\hat\lambda_3&gt;\hat\lambda_4&gt;\hat\lambda_5\)</span> be the eigenvalues of <span class="math inline">\(\hat\Sigma\)</span>, where <span class="math inline">\(\hat\Sigma\)</span> is the MLE of <span class="math inline">\(\Sigma\)</span>. Compute the sample estimate <span class="math display">\[\hat\theta=\frac{\hat\lambda_1}{\sum_{j=1}^{n}\lambda_j}\]</span> ofθ. Use bootstrap to estimate the bias and standard error ofˆθ.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(scor)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>lambda_hat <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(scor))<span class="sc">$</span>values</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>theta_hat <span class="ot">&lt;-</span> lambda_hat[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(lambda_hat)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  scor1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(scor, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(scor1))<span class="sc">$</span>values</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  theta[b] <span class="ot">&lt;-</span> lambda[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(lambda)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>bias_boot <span class="ot">&lt;-</span> <span class="fu">mean</span>(theta) <span class="sc">-</span> theta_hat</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>se_boot <span class="ot">&lt;-</span> <span class="fu">sd</span>(theta)</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">c</span>(<span class="st">&#39;bias_boot&#39;</span><span class="ot">=</span>bias_boot,<span class="st">&#39;se_boot&#39;</span><span class="ot">=</span>se_boot),<span class="dv">4</span>))</span></code></pre></div>
<pre><code>## bias_boot   se_boot 
##    0.0061    0.0079</code></pre>
<p>7.8 Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat\theta\)</span></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(scor)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>lambda_hat <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(scor))<span class="sc">$</span>values</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>theta_hat <span class="ot">&lt;-</span> lambda_hat[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(lambda_hat)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>theta_j <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> scor[<span class="sc">-</span>i,]</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(x))<span class="sc">$</span>values</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  theta_j[i] <span class="ot">&lt;-</span> lambda[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda)</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>bias_jack <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta_j) <span class="sc">-</span> theta_hat)</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>se_jack <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sqrt</span>(<span class="fu">var</span>(theta_j)<span class="sc">/</span>n)</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">c</span>(<span class="st">&#39;bias_jack&#39;</span><span class="ot">=</span>bias_jack,<span class="st">&#39;se_jack&#39;</span><span class="ot">=</span>se_jack),<span class="dv">4</span>))</span></code></pre></div>
<pre><code>## bias_jack   se_jack 
##    0.0011    0.0496</code></pre>
<p>7.9 Refer to Exercise 7.7. Compute 95% percentile and BCa confidence intervals for <span class="math inline">\(\hat\theta\)</span></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 95% percentile confidence intervals</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>theta.boot <span class="ot">&lt;-</span> <span class="cf">function</span>(dat,i){</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(dat[i,]))<span class="sc">$</span>values</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  theta <span class="ot">&lt;-</span> lambda[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(lambda)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  theta</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> scor</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>boot.obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(dat, <span class="at">statistic =</span> theta.boot, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(boot.obj)</span></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = dat, statistic = theta.boot, R = 1000)
## 
## 
## Bootstrap Statistics :
##     original      bias    std. error
## t1* 0.619115 0.002245862  0.04740343</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">quantile</span>(boot.obj<span class="sc">$</span>t, alpha, <span class="at">type=</span><span class="dv">6</span>))</span></code></pre></div>
<pre><code>##      2.5%     97.5% 
## 0.5227241 0.7063602</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 95% BCa confidence intervals</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>theta.boot <span class="ot">&lt;-</span> <span class="cf">function</span>(dat,i){</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(dat[i,]))<span class="sc">$</span>values</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  theta <span class="ot">&lt;-</span> lambda[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(lambda)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  theta</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> scor</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>boot.obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(dat, <span class="at">statistic =</span> theta.boot, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">boot.ci</span>(boot.obj, <span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;bca&quot;</span>,<span class="st">&quot;perc&quot;</span>)))</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 1000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot.obj, type = c(&quot;bca&quot;, &quot;perc&quot;))
## 
## Intervals : 
## Level     Percentile            BCa          
## 95%   ( 0.5208,  0.7157 )   ( 0.5164,  0.7067 )  
## Calculations and Intervals on Original Scale</code></pre>
<p>percentile置信区间计算了两遍，两次结果相差不大</p>
<p>7.B Repeat Project 7.A for the sample skewness statistic. Compare the coverage rates for normal populations (skewness 0) andχ2(5) distributions (positive skewness)</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>boot1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i){</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  xm <span class="ot">&lt;-</span> <span class="fu">mean</span>(x[i])</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  m3 <span class="ot">&lt;-</span> <span class="fu">mean</span>((x <span class="sc">-</span> xm)<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  m2 <span class="ot">&lt;-</span> <span class="fu">mean</span>((x <span class="sc">-</span> xm)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  skewness <span class="ot">&lt;-</span> m3 <span class="sc">/</span> m2<span class="sc">^</span><span class="fl">1.5</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>  boot.obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(x, <span class="at">statistic =</span> boot1, <span class="at">R=</span><span class="dv">1000</span>)</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(boot.obj,<span class="at">conf=</span><span class="fl">0.95</span>,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&#39;basic&#39;</span>,<span class="st">&#39;norm&#39;</span>,<span class="st">&#39;perc&#39;</span>))</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>  p1[i] <span class="ot">&lt;-</span> (a<span class="sc">$</span>norm[<span class="dv">2</span>]<span class="sc">&lt;</span><span class="dv">0</span>)<span class="sc">*</span>(<span class="dv">0</span><span class="sc">&lt;</span>a<span class="sc">$</span>norm[<span class="dv">3</span>])</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>  p2[i] <span class="ot">&lt;-</span> (a<span class="sc">$</span>perc[<span class="dv">4</span>]<span class="sc">&lt;</span><span class="dv">0</span>)<span class="sc">*</span>(<span class="dv">0</span><span class="sc">&lt;</span>a<span class="sc">$</span>perc[<span class="dv">5</span>])</span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>  p3[i] <span class="ot">&lt;-</span> (a<span class="sc">$</span>basic[<span class="dv">4</span>]<span class="sc">&lt;</span><span class="dv">0</span>)<span class="sc">*</span>(<span class="dv">0</span><span class="sc">&lt;</span>a<span class="sc">$</span>basic[<span class="dv">5</span>])</span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(p1)</span></code></pre></div>
<pre><code>## [1] 0.97</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(p2)</span></code></pre></div>
<pre><code>## [1] 0.99</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(p3)</span></code></pre></div>
<pre><code>## [1] 0.97</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n,<span class="dv">5</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>boot2 <span class="ot">&lt;-</span> <span class="cf">function</span>(y,i){</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  ym <span class="ot">&lt;-</span> <span class="fu">mean</span>(y[i])</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  m3 <span class="ot">&lt;-</span> <span class="fu">mean</span>((y <span class="sc">-</span> ym)<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  m2 <span class="ot">&lt;-</span> <span class="fu">mean</span>((y <span class="sc">-</span> ym)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  skewness <span class="ot">&lt;-</span> m3 <span class="sc">/</span> m2<span class="sc">^</span><span class="fl">1.5</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>skew <span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="dv">8</span><span class="sc">/</span><span class="dv">5</span>)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>r1 <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>r3 <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n,<span class="dv">5</span>)</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>  boot.obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(y, <span class="at">statistic =</span> boot2, <span class="at">R=</span><span class="dv">1000</span>)</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(boot.obj,<span class="at">conf=</span><span class="fl">0.95</span>,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&#39;basic&#39;</span>,<span class="st">&#39;norm&#39;</span>,<span class="st">&#39;perc&#39;</span>))</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>  r1[i] <span class="ot">&lt;-</span> (b<span class="sc">$</span>norm[<span class="dv">2</span>]<span class="sc">&lt;</span>skew)<span class="sc">*</span>(skew<span class="sc">&lt;</span>b<span class="sc">$</span>norm[<span class="dv">3</span>])</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>  r2[i] <span class="ot">&lt;-</span> (b<span class="sc">$</span>perc[<span class="dv">4</span>]<span class="sc">&lt;</span>skew)<span class="sc">*</span>(skew<span class="sc">&lt;</span>b<span class="sc">$</span>perc[<span class="dv">5</span>])</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>  r3[i] <span class="ot">&lt;-</span> (b<span class="sc">$</span>basic[<span class="dv">4</span>]<span class="sc">&lt;</span>skew)<span class="sc">*</span>(skew<span class="sc">&lt;</span>b<span class="sc">$</span>basic[<span class="dv">5</span>])</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(r1)</span></code></pre></div>
<pre><code>## [1] 0.8</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(r2)</span></code></pre></div>
<pre><code>## [1] 0.76</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(r3)</span></code></pre></div>
<pre><code>## [1] 0.8</code></pre>
</div>
<div id="hw6-2021-11-04" class="section level2">
<h2>HW6 2021-11-04</h2>
</div>
<div id="question-1-1" class="section level2">
<h2>Question 1</h2>
<p>Exercise 8.2 (page 242, Statistical Computating with R).</p>
<p>8.2 Implement the bivariate Spearman rank correlation test for independence [255] as a permutation test. The Spearman rank correlation test statistic can be obtained from function cor with method = “spearman”. Compare the achieved significance level of the permutation test with the p-value reported by cor.test on the same samples.</p>
</div>
<div id="answer-1-1" class="section level2">
<h2>Answer 1</h2>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">54</span>,<span class="dv">13</span>,<span class="dv">45</span>,<span class="dv">32</span>,<span class="dv">2</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">78</span>,<span class="dv">28</span>,<span class="dv">46</span>,<span class="dv">69</span>,<span class="dv">46</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>abc <span class="ot">&lt;-</span> <span class="fu">c</span>(a, b)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>gs <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">length</span>(a)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>len <span class="ot">&lt;-</span> <span class="fu">numeric</span>(M)</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> (<span class="fu">cor.test</span>(a, b, <span class="at">method=</span><span class="st">&#39;spearman&#39;</span>))<span class="sc">$</span>estimate</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M) {</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>  gs <span class="ot">&lt;-</span> <span class="fu">sample</span>(gs, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>  a1 <span class="ot">&lt;-</span> abc[gs]</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>  b1 <span class="ot">&lt;-</span> abc[<span class="sc">-</span>gs]</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>  len[i] <span class="ot">&lt;-</span> (<span class="fu">cor.test</span>(a1, b1,<span class="at">method=</span><span class="st">&#39;spearman&#39;</span>))<span class="sc">$</span>estimate</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(t0, len)) <span class="sc">&gt;=</span> <span class="fu">abs</span>(t0))</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(p,(<span class="fu">cor.test</span>(a, b, <span class="at">method=</span><span class="st">&#39;spearman&#39;</span>))<span class="sc">$</span>p.value),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.152 0.148</code></pre>
</div>
<div id="question-2-1" class="section level2">
<h2>Question 2</h2>
<p>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations. Unequal variances and equal expectations Unequal variances and unequal expectations Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions) Unbalanced samples (say, 1 case versus 10 controls) Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8).</p>
</div>
<div id="answer-2.1" class="section level2">
<h2>Answer 2.1</h2>
<p>Unequal variances and equal expectations(Multiple normal distribution) distribution1: expectation:<span class="math inline">\(\mu_1=(0,0)\)</span> covariance:<span class="math display">\[\Sigma_{1}=\left(\begin{array}{ccc} 1 &amp; 0 \\ 0 &amp; 1 \end{array}\right)\]</span> distribution2: expectation:<span class="math inline">\(\mu_2=(0,0)\)</span> covariance:<span class="math display">\[\Sigma_{2}=\left(\begin{array}{ccc} 3 &amp; 0 \\ 0 &amp; 3 \end{array}\right)\]</span></p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RANN)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Ball)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(energy)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>Function1 <span class="ot">&lt;-</span> <span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  n1 <span class="ot">&lt;-</span> sizes[<span class="dv">1</span>]</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  n2 <span class="ot">&lt;-</span> sizes[<span class="dv">2</span>]</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> n1 <span class="sc">+</span> n2</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> z[ix, ]</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>  NN <span class="ot">&lt;-</span> <span class="fu">nn2</span>(<span class="at">data=</span>z, <span class="at">k=</span>k<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[<span class="dv">1</span><span class="sc">:</span>n1,]</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[(n1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n,]</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>  i1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(x1 <span class="sc">&lt;</span> n1 <span class="sc">+</span> .<span class="dv">5</span>)</span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>  i2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(x2 <span class="sc">&gt;</span> n1<span class="fl">+.5</span>)</span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>  (i1 <span class="sc">+</span> i2) <span class="sc">/</span> (k <span class="sc">*</span> n)</span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>test.nn <span class="ot">&lt;-</span> <span class="cf">function</span>(z,sizes,k){</span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>  boot.obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>z, <span class="at">statistic=</span>Function1, <span class="at">R=</span>R, <span class="at">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="at">sizes=</span>sizes, <span class="at">k=</span>k)</span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>  vec <span class="ot">&lt;-</span> <span class="fu">c</span>(boot.obj<span class="sc">$</span>t0,boot.obj<span class="sc">$</span>t)</span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">mean</span>(vec <span class="sc">&gt;=</span> vec[<span class="dv">1</span>])</span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">statistic=</span>vec[<span class="dv">1</span>],<span class="at">p.value=</span>p)</span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1111</span>)</span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a>u11 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a>sigma11 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb61-31"><a href="#cb61-31" aria-hidden="true" tabindex="-1"></a>u12 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb61-32"><a href="#cb61-32" aria-hidden="true" tabindex="-1"></a>sigma12 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>),<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb61-33"><a href="#cb61-33" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">28</span></span>
<span id="cb61-34"><a href="#cb61-34" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="dv">28</span></span>
<span id="cb61-35"><a href="#cb61-35" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> n1<span class="sc">+</span>n2 </span>
<span id="cb61-36"><a href="#cb61-36" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">c</span>(n1,n2)</span>
<span id="cb61-37"><a href="#cb61-37" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb61-38"><a href="#cb61-38" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">99</span></span>
<span id="cb61-39"><a href="#cb61-39" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">88</span></span>
<span id="cb61-40"><a href="#cb61-40" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb61-41"><a href="#cb61-41" aria-hidden="true" tabindex="-1"></a>pvalue <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb61-42"><a href="#cb61-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-43"><a href="#cb61-43" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb61-44"><a href="#cb61-44" aria-hidden="true" tabindex="-1"></a>  sj1 <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n1,u11,sigma11)</span>
<span id="cb61-45"><a href="#cb61-45" aria-hidden="true" tabindex="-1"></a>  sj2 <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n2,u12,sigma12)</span>
<span id="cb61-46"><a href="#cb61-46" aria-hidden="true" tabindex="-1"></a>  sj <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sj1,sj2)</span>
<span id="cb61-47"><a href="#cb61-47" aria-hidden="true" tabindex="-1"></a>  pvalue[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">test.nn</span>(sj,N,k)<span class="sc">$</span>p.value</span>
<span id="cb61-48"><a href="#cb61-48" aria-hidden="true" tabindex="-1"></a>  pvalue[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(sj,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb61-49"><a href="#cb61-49" aria-hidden="true" tabindex="-1"></a>  pvalue[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>sj1,<span class="at">y=</span>sj2,<span class="at">num.permutations=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb61-50"><a href="#cb61-50" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-51"><a href="#cb61-51" aria-hidden="true" tabindex="-1"></a>a1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(pvalue[,<span class="dv">1</span>]<span class="sc">&lt;</span>alpha)</span>
<span id="cb61-52"><a href="#cb61-52" aria-hidden="true" tabindex="-1"></a>a2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(pvalue[,<span class="dv">2</span>]<span class="sc">&lt;</span>alpha)</span>
<span id="cb61-53"><a href="#cb61-53" aria-hidden="true" tabindex="-1"></a>a3 <span class="ot">&lt;-</span> <span class="fu">mean</span>(pvalue[,<span class="dv">3</span>]<span class="sc">&lt;</span>alpha)</span>
<span id="cb61-54"><a href="#cb61-54" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(a1,a2,a3))</span></code></pre></div>
<pre><code>## [1] 0.2954545 0.3863636 0.8863636</code></pre>
</div>
<div id="answer-2.2" class="section level2">
<h2>Answer 2.2</h2>
<p>Unequal variances and unequal expectations</p>
<p>distribution1: expectation:<span class="math inline">\(\mu_1=(0,0)\)</span> covariance:<span class="math display">\[\Sigma_{1}=\left(\begin{array}{ccc} 1 &amp; 0 \\ 0 &amp; 1 \end{array}\right)\]</span> distribution2: expectation:<span class="math inline">\(\mu_2=(1,1)\)</span> covariance:<span class="math display">\[\Sigma_{2}=\left(\begin{array}{ccc} 4 &amp; 0 \\ 0 &amp; 4 \end{array}\right)\]</span></p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RANN)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Ball)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(energy)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>Function1 <span class="ot">&lt;-</span> <span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>  n1 <span class="ot">&lt;-</span> sizes[<span class="dv">1</span>]</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>  n2 <span class="ot">&lt;-</span> sizes[<span class="dv">2</span>]</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> n1 <span class="sc">+</span> n2</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> z[ix, ]</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  NN <span class="ot">&lt;-</span> <span class="fu">nn2</span>(<span class="at">data=</span>z, <span class="at">k=</span>k<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[<span class="dv">1</span><span class="sc">:</span>n1,]</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[(n1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n,]</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>  i1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(x1 <span class="sc">&lt;</span> n1 <span class="sc">+</span> .<span class="dv">5</span>)</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>  i2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(x2 <span class="sc">&gt;</span> n1<span class="fl">+.5</span>)</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>  (i1 <span class="sc">+</span> i2) <span class="sc">/</span> (k <span class="sc">*</span> n)</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>test.nn <span class="ot">&lt;-</span> <span class="cf">function</span>(z,sizes,k){</span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>  boot.obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>z, <span class="at">statistic=</span>Function1, <span class="at">R=</span>R, <span class="at">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="at">sizes=</span>sizes, <span class="at">k=</span>k)</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>  vec <span class="ot">&lt;-</span> <span class="fu">c</span>(boot.obj<span class="sc">$</span>t0,boot.obj<span class="sc">$</span>t)</span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">mean</span>(vec <span class="sc">&gt;=</span> vec[<span class="dv">1</span>])</span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">statistic=</span>vec[<span class="dv">1</span>],<span class="at">p.value=</span>p)</span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>u21 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>sigma21 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a>u22 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a>sigma22 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>),<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">28</span></span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="dv">28</span></span>
<span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> n1<span class="sc">+</span>n2 </span>
<span id="cb63-35"><a href="#cb63-35" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">c</span>(n1,n2)</span>
<span id="cb63-36"><a href="#cb63-36" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb63-37"><a href="#cb63-37" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">99</span></span>
<span id="cb63-38"><a href="#cb63-38" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">88</span></span>
<span id="cb63-39"><a href="#cb63-39" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb63-40"><a href="#cb63-40" aria-hidden="true" tabindex="-1"></a>pvalue <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb63-41"><a href="#cb63-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-42"><a href="#cb63-42" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb63-43"><a href="#cb63-43" aria-hidden="true" tabindex="-1"></a>  sj1 <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n1,u21,sigma21)</span>
<span id="cb63-44"><a href="#cb63-44" aria-hidden="true" tabindex="-1"></a>  sj2 <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n2,u22,sigma22)</span>
<span id="cb63-45"><a href="#cb63-45" aria-hidden="true" tabindex="-1"></a>  sj <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sj1,sj2)</span>
<span id="cb63-46"><a href="#cb63-46" aria-hidden="true" tabindex="-1"></a>  pvalue[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">test.nn</span>(sj,N,k)<span class="sc">$</span>p.value</span>
<span id="cb63-47"><a href="#cb63-47" aria-hidden="true" tabindex="-1"></a>  pvalue[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(sj,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb63-48"><a href="#cb63-48" aria-hidden="true" tabindex="-1"></a>  pvalue[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>sj1,<span class="at">y=</span>sj2,<span class="at">num.permutations=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb63-49"><a href="#cb63-49" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-50"><a href="#cb63-50" aria-hidden="true" tabindex="-1"></a>a1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(pvalue[,<span class="dv">1</span>]<span class="sc">&lt;</span>alpha)</span>
<span id="cb63-51"><a href="#cb63-51" aria-hidden="true" tabindex="-1"></a>a2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(pvalue[,<span class="dv">2</span>]<span class="sc">&lt;</span>alpha)</span>
<span id="cb63-52"><a href="#cb63-52" aria-hidden="true" tabindex="-1"></a>a3 <span class="ot">&lt;-</span> <span class="fu">mean</span>(pvalue[,<span class="dv">3</span>]<span class="sc">&lt;</span>alpha)</span>
<span id="cb63-53"><a href="#cb63-53" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(a1,a2,a3))</span></code></pre></div>
<pre><code>## [1] 0.8068182 0.9659091 1.0000000</code></pre>
</div>
<div id="answer-2.3" class="section level2">
<h2>Answer 2.3</h2>
<p>Non-normal distributions: t distribution with 1 df (heavy-tailed distribution)bimodel distribution (mixture of two normal distributions) <span class="math display">\[t(1,3)\]</span> <span class="math display">\[t(1,6)\]</span></p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RANN)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Ball)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(energy)</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>Function1 <span class="ot">&lt;-</span> <span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>  n1 <span class="ot">&lt;-</span> sizes[<span class="dv">1</span>]</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>  n2 <span class="ot">&lt;-</span> sizes[<span class="dv">2</span>]</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> n1 <span class="sc">+</span> n2</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> z[ix, ]</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>  NN <span class="ot">&lt;-</span> <span class="fu">nn2</span>(<span class="at">data=</span>z, <span class="at">k=</span>k<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[<span class="dv">1</span><span class="sc">:</span>n1,]</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[(n1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n,]</span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>  i1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(x1 <span class="sc">&lt;</span> n1 <span class="sc">+</span> .<span class="dv">5</span>)</span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>  i2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(x2 <span class="sc">&gt;</span> n1<span class="fl">+.5</span>)</span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>  (i1 <span class="sc">+</span> i2) <span class="sc">/</span> (k <span class="sc">*</span> n)</span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a>test.nn <span class="ot">&lt;-</span> <span class="cf">function</span>(z,sizes,k){</span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a>  boot.obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>z, <span class="at">statistic=</span>Function1, <span class="at">R=</span>R, <span class="at">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="at">sizes=</span>sizes, <span class="at">k=</span>k)</span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a>  vec <span class="ot">&lt;-</span> <span class="fu">c</span>(boot.obj<span class="sc">$</span>t0,boot.obj<span class="sc">$</span>t)</span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">mean</span>(vec <span class="sc">&gt;=</span> vec[<span class="dv">1</span>])</span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">statistic=</span>vec[<span class="dv">1</span>],<span class="at">p.value=</span>p)</span>
<span id="cb65-26"><a href="#cb65-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb65-27"><a href="#cb65-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-28"><a href="#cb65-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-29"><a href="#cb65-29" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">28</span></span>
<span id="cb65-30"><a href="#cb65-30" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="dv">28</span></span>
<span id="cb65-31"><a href="#cb65-31" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> n1<span class="sc">+</span>n2 </span>
<span id="cb65-32"><a href="#cb65-32" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">c</span>(n1,n2)</span>
<span id="cb65-33"><a href="#cb65-33" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb65-34"><a href="#cb65-34" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">99</span></span>
<span id="cb65-35"><a href="#cb65-35" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">88</span></span>
<span id="cb65-36"><a href="#cb65-36" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb65-37"><a href="#cb65-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-38"><a href="#cb65-38" aria-hidden="true" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb65-39"><a href="#cb65-39" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb65-40"><a href="#cb65-40" aria-hidden="true" tabindex="-1"></a>  sj1 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">rt</span>(n1,<span class="dv">1</span>,<span class="dv">3</span>),<span class="at">ncol=</span><span class="dv">1</span>)</span>
<span id="cb65-41"><a href="#cb65-41" aria-hidden="true" tabindex="-1"></a>  sj2 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">rt</span>(n2,<span class="dv">1</span>,<span class="dv">6</span>),<span class="at">ncol=</span><span class="dv">1</span>)</span>
<span id="cb65-42"><a href="#cb65-42" aria-hidden="true" tabindex="-1"></a>  sj <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sj1,sj2)</span>
<span id="cb65-43"><a href="#cb65-43" aria-hidden="true" tabindex="-1"></a>  p_value[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">test.nn</span>(sj,N,k)<span class="sc">$</span>p.value</span>
<span id="cb65-44"><a href="#cb65-44" aria-hidden="true" tabindex="-1"></a>  p_value[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(sj,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb65-45"><a href="#cb65-45" aria-hidden="true" tabindex="-1"></a>  p_value[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>sj1,<span class="at">y=</span>sj2,<span class="at">num.permutations=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb65-46"><a href="#cb65-46" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb65-47"><a href="#cb65-47" aria-hidden="true" tabindex="-1"></a>a1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(p_value[,<span class="dv">1</span>]<span class="sc">&lt;</span>alpha)</span>
<span id="cb65-48"><a href="#cb65-48" aria-hidden="true" tabindex="-1"></a>a2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(p_value[,<span class="dv">2</span>]<span class="sc">&lt;</span>alpha)</span>
<span id="cb65-49"><a href="#cb65-49" aria-hidden="true" tabindex="-1"></a>a3 <span class="ot">&lt;-</span> <span class="fu">mean</span>(p_value[,<span class="dv">3</span>]<span class="sc">&lt;</span>alpha)</span>
<span id="cb65-50"><a href="#cb65-50" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(a1,a2,a3))</span></code></pre></div>
<pre><code>## [1] 0.2840909 0.3409091 0.6136364</code></pre>
<p>bimodel distribution (mixture of two normal distributions) x1 ~ distribution1: expectation:<span class="math inline">\(\mu_1=(0,0)\)</span> covariance:<span class="math display">\[\Sigma_{1}=\left(\begin{array}{ccc} 1 &amp; 0 \\ 0 &amp; 1 \end{array}\right)\]</span> x2 ~ distribution2: expectation:<span class="math inline">\(\mu_2=(2,5)\)</span> covariance:<span class="math display">\[\Sigma_{2}=\left(\begin{array}{ccc} 8 &amp; 0 \\ 0 &amp; 2 \end{array}\right)\]</span> <span class="math display">\[sj_1 = 0.3*x_1 + 0.7*x_2\]</span> x3 ~ distribution1: expectation:<span class="math inline">\(\mu_1=(1,4)\)</span> covariance:<span class="math display">\[\Sigma_{1}=\left(\begin{array}{ccc} 2 &amp; 0 \\ 0 &amp; 3 \end{array}\right)\]</span> x4 ~ distribution2: expectation:<span class="math inline">\(\mu_2=(3,7)\)</span> covariance:<span class="math display">\[\Sigma_{2}=\left(\begin{array}{ccc} 4 &amp; 0 \\ 0 &amp; 6 \end{array}\right)\]</span> <span class="math display">\[sj_2 = 0.4*x_3 + 0.6*x_4\]</span></p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RANN)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Ball)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(energy)</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>Function1 <span class="ot">&lt;-</span> <span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>  n1 <span class="ot">&lt;-</span> sizes[<span class="dv">1</span>]</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>  n2 <span class="ot">&lt;-</span> sizes[<span class="dv">2</span>]</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> n1 <span class="sc">+</span> n2</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> z[ix, ]</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>  NN <span class="ot">&lt;-</span> <span class="fu">nn2</span>(<span class="at">data=</span>z, <span class="at">k=</span>k<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[<span class="dv">1</span><span class="sc">:</span>n1,]</span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[(n1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n,]</span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>  i1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(x1 <span class="sc">&lt;</span> n1 <span class="sc">+</span> .<span class="dv">5</span>)</span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>  i2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(x2 <span class="sc">&gt;</span> n1<span class="fl">+.5</span>)</span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>  (i1 <span class="sc">+</span> i2) <span class="sc">/</span> (k <span class="sc">*</span> n)</span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a>test.nn <span class="ot">&lt;-</span> <span class="cf">function</span>(z,sizes,k){</span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a>  boot.obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>z, <span class="at">statistic=</span>Function1, <span class="at">R=</span>R, <span class="at">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="at">sizes=</span>sizes, <span class="at">k=</span>k)</span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a>  vec <span class="ot">&lt;-</span> <span class="fu">c</span>(boot.obj<span class="sc">$</span>t0,boot.obj<span class="sc">$</span>t)</span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">mean</span>(vec <span class="sc">&gt;=</span> vec[<span class="dv">1</span>])</span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">statistic=</span>vec[<span class="dv">1</span>],<span class="at">p.value=</span>p)</span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a>n41 <span class="ot">&lt;-</span> <span class="dv">18</span></span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a>n42 <span class="ot">&lt;-</span> <span class="dv">18</span></span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true" tabindex="-1"></a>n43 <span class="ot">&lt;-</span> <span class="dv">28</span></span>
<span id="cb67-31"><a href="#cb67-31" aria-hidden="true" tabindex="-1"></a>n44 <span class="ot">&lt;-</span> <span class="dv">28</span></span>
<span id="cb67-32"><a href="#cb67-32" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> n41</span>
<span id="cb67-33"><a href="#cb67-33" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> n43</span>
<span id="cb67-34"><a href="#cb67-34" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> n1<span class="sc">+</span>n2</span>
<span id="cb67-35"><a href="#cb67-35" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">c</span>(n1,n2)</span>
<span id="cb67-36"><a href="#cb67-36" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb67-37"><a href="#cb67-37" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">99</span></span>
<span id="cb67-38"><a href="#cb67-38" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">88</span></span>
<span id="cb67-39"><a href="#cb67-39" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb67-40"><a href="#cb67-40" aria-hidden="true" tabindex="-1"></a>pvalue <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb67-41"><a href="#cb67-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-42"><a href="#cb67-42" aria-hidden="true" tabindex="-1"></a>u31 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb67-43"><a href="#cb67-43" aria-hidden="true" tabindex="-1"></a>sigma31 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb67-44"><a href="#cb67-44" aria-hidden="true" tabindex="-1"></a>u32 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">5</span>)</span>
<span id="cb67-45"><a href="#cb67-45" aria-hidden="true" tabindex="-1"></a>sigma32 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>),<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb67-46"><a href="#cb67-46" aria-hidden="true" tabindex="-1"></a>u33 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)</span>
<span id="cb67-47"><a href="#cb67-47" aria-hidden="true" tabindex="-1"></a>sigma33 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>),<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb67-48"><a href="#cb67-48" aria-hidden="true" tabindex="-1"></a>u34 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">7</span>)</span>
<span id="cb67-49"><a href="#cb67-49" aria-hidden="true" tabindex="-1"></a>sigma34 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">6</span>),<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb67-50"><a href="#cb67-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-51"><a href="#cb67-51" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb67-52"><a href="#cb67-52" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n41,u31,sigma31)</span>
<span id="cb67-53"><a href="#cb67-53" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n42,u32,sigma32)</span>
<span id="cb67-54"><a href="#cb67-54" aria-hidden="true" tabindex="-1"></a>  x3 <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n43,u33,sigma33)</span>
<span id="cb67-55"><a href="#cb67-55" aria-hidden="true" tabindex="-1"></a>  x4 <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n44,u34,sigma34)</span>
<span id="cb67-56"><a href="#cb67-56" aria-hidden="true" tabindex="-1"></a>  sj1 <span class="ot">&lt;-</span> <span class="fl">0.3</span><span class="sc">*</span>x1 <span class="sc">+</span> <span class="fl">0.7</span><span class="sc">*</span>x2</span>
<span id="cb67-57"><a href="#cb67-57" aria-hidden="true" tabindex="-1"></a>  sj2 <span class="ot">&lt;-</span> <span class="fl">0.4</span><span class="sc">*</span>x3 <span class="sc">+</span> <span class="fl">0.6</span><span class="sc">*</span>x4</span>
<span id="cb67-58"><a href="#cb67-58" aria-hidden="true" tabindex="-1"></a>  sj <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sj1,sj2)</span>
<span id="cb67-59"><a href="#cb67-59" aria-hidden="true" tabindex="-1"></a>  pvalue[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">test.nn</span>(sj,N,k)<span class="sc">$</span>p.value</span>
<span id="cb67-60"><a href="#cb67-60" aria-hidden="true" tabindex="-1"></a>  pvalue[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(sj,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb67-61"><a href="#cb67-61" aria-hidden="true" tabindex="-1"></a>  pvalue[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>sj1,<span class="at">y=</span>sj2,<span class="at">num.permutations=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb67-62"><a href="#cb67-62" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb67-63"><a href="#cb67-63" aria-hidden="true" tabindex="-1"></a>a1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(pvalue[,<span class="dv">1</span>]<span class="sc">&lt;</span>alpha)</span>
<span id="cb67-64"><a href="#cb67-64" aria-hidden="true" tabindex="-1"></a>a2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(pvalue[,<span class="dv">2</span>]<span class="sc">&lt;</span>alpha)</span>
<span id="cb67-65"><a href="#cb67-65" aria-hidden="true" tabindex="-1"></a>a3 <span class="ot">&lt;-</span> <span class="fu">mean</span>(pvalue[,<span class="dv">3</span>]<span class="sc">&lt;</span>alpha)</span>
<span id="cb67-66"><a href="#cb67-66" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(a1,a2,a3))</span></code></pre></div>
<pre><code>## [1] 0.875 1.000 1.000</code></pre>
</div>
<div id="answer-2.4" class="section level2">
<h2>Answer 2.4</h2>
<p>Unbalanced samples (say, 1 case versus 10 controls) distribution1: expectation:<span class="math inline">\(\mu_1=(0,0)\)</span> covariance:<span class="math display">\[\Sigma_{1}=\left(\begin{array}{ccc} 1 &amp; 0 \\ 0 &amp; 1 \end{array}\right)\]</span> distribution2: expectation:<span class="math inline">\(\mu_2=(0,0)\)</span> covariance:<span class="math display">\[\Sigma_{2}=\left(\begin{array}{ccc} 3 &amp; 0 \\ 0 &amp; 3 \end{array}\right)\]</span> with <span class="math inline">\(n_1=38,n_2=28\)</span></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RANN)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Ball)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(energy)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>Function1 <span class="ot">&lt;-</span> <span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  n1 <span class="ot">&lt;-</span> sizes[<span class="dv">1</span>]</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>  n2 <span class="ot">&lt;-</span> sizes[<span class="dv">2</span>]</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> n1 <span class="sc">+</span> n2</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> z[ix, ]</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>  NN <span class="ot">&lt;-</span> <span class="fu">nn2</span>(<span class="at">data=</span>z, <span class="at">k=</span>k<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[<span class="dv">1</span><span class="sc">:</span>n1,]</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[(n1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n,]</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>  i1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(x1 <span class="sc">&lt;</span> n1 <span class="sc">+</span> .<span class="dv">5</span>)</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>  i2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(x2 <span class="sc">&gt;</span> n1<span class="fl">+.5</span>)</span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>  (i1 <span class="sc">+</span> i2) <span class="sc">/</span> (k <span class="sc">*</span> n)</span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a>test.nn <span class="ot">&lt;-</span> <span class="cf">function</span>(z,sizes,k){</span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a>  boot.obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>z, <span class="at">statistic=</span>Function1, <span class="at">R=</span>R, <span class="at">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="at">sizes=</span>sizes, <span class="at">k=</span>k)</span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a>  vec <span class="ot">&lt;-</span> <span class="fu">c</span>(boot.obj<span class="sc">$</span>t0,boot.obj<span class="sc">$</span>t)</span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">mean</span>(vec <span class="sc">&gt;=</span> vec[<span class="dv">1</span>])</span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">statistic=</span>vec[<span class="dv">1</span>],<span class="at">p.value=</span>p)</span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a>u41 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true" tabindex="-1"></a>sigma41 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true" tabindex="-1"></a>u42 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb69-31"><a href="#cb69-31" aria-hidden="true" tabindex="-1"></a>sigma42 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>),<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb69-32"><a href="#cb69-32" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">38</span></span>
<span id="cb69-33"><a href="#cb69-33" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="dv">28</span></span>
<span id="cb69-34"><a href="#cb69-34" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> n1<span class="sc">+</span>n2 </span>
<span id="cb69-35"><a href="#cb69-35" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">c</span>(n1,n2)</span>
<span id="cb69-36"><a href="#cb69-36" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb69-37"><a href="#cb69-37" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">99</span></span>
<span id="cb69-38"><a href="#cb69-38" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">88</span></span>
<span id="cb69-39"><a href="#cb69-39" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb69-40"><a href="#cb69-40" aria-hidden="true" tabindex="-1"></a>pvalue <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb69-41"><a href="#cb69-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-42"><a href="#cb69-42" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb69-43"><a href="#cb69-43" aria-hidden="true" tabindex="-1"></a>  sj1 <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n1,u41,sigma41)</span>
<span id="cb69-44"><a href="#cb69-44" aria-hidden="true" tabindex="-1"></a>  sj2 <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n2,u42,sigma42)</span>
<span id="cb69-45"><a href="#cb69-45" aria-hidden="true" tabindex="-1"></a>  sj <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sj1,sj2)</span>
<span id="cb69-46"><a href="#cb69-46" aria-hidden="true" tabindex="-1"></a>  pvalue[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">test.nn</span>(sj,N,k)<span class="sc">$</span>p.value</span>
<span id="cb69-47"><a href="#cb69-47" aria-hidden="true" tabindex="-1"></a>  pvalue[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(sj,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb69-48"><a href="#cb69-48" aria-hidden="true" tabindex="-1"></a>  pvalue[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>sj1,<span class="at">y=</span>sj2,<span class="at">num.permutations=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb69-49"><a href="#cb69-49" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb69-50"><a href="#cb69-50" aria-hidden="true" tabindex="-1"></a>a1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(pvalue[,<span class="dv">1</span>]<span class="sc">&lt;</span>alpha)</span>
<span id="cb69-51"><a href="#cb69-51" aria-hidden="true" tabindex="-1"></a>a2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(pvalue[,<span class="dv">2</span>]<span class="sc">&lt;</span>alpha)</span>
<span id="cb69-52"><a href="#cb69-52" aria-hidden="true" tabindex="-1"></a>a3 <span class="ot">&lt;-</span> <span class="fu">mean</span>(pvalue[,<span class="dv">3</span>]<span class="sc">&lt;</span>alpha)</span>
<span id="cb69-53"><a href="#cb69-53" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(a1,a2,a3))</span></code></pre></div>
<pre><code>## [1] 0.4431818 0.4886364 0.8977273</code></pre>
</div>
<div id="hw7-2021-11-11" class="section level2">
<h2>HW7 2021-11-11</h2>
</div>
<div id="question-9.3" class="section level2">
<h2>Question 9.3</h2>
<p>Use the Metropolis-Hastings sampler to generate random variables from a standard Cauchy distribution. Discard the first 1000 of the chain, and compare the deciles of the generated observations with the deciles of the standard Cauchy distribution (see qcauchy or qt with df=1). Recall that a Cauchy(θ, η) distribution has density function. <span class="math display">\[f(x)=\frac{1}{\theta\pi(1+[(x-\eta)/\theta]^2)},-\infty&lt;x&lt;+\infty,\theta&gt;0\]</span> The standard Cauchy has the Cauchy(θ = 1, η = 0) density. (Note that the standard Cauchy density is equal to the Student t density with one degree of freedom.) ## Answer 9.3</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1122</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x,theta,eta){</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (<span class="dv">1</span> <span class="sc">/</span> (theta<span class="sc">*</span>pi<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>((x<span class="sc">-</span>eta)<span class="sc">/</span>theta)<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>eta <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m){</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>  xt <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,xt,<span class="dv">1</span>)</span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>  l <span class="ot">&lt;-</span> <span class="fu">f</span>(y,theta,eta)<span class="sc">*</span><span class="fu">dnorm</span>(xt,y,<span class="dv">1</span>)</span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">f</span>(xt,theta,eta)<span class="sc">*</span><span class="fu">dnorm</span>(y,xt,<span class="dv">1</span>)</span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (u[i] <span class="sc">&lt;</span> l<span class="sc">/</span>d) {</span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>    x[i] <span class="ot">&lt;-</span> y</span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span>{</span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a>    x[i]<span class="ot">&lt;-</span> xt</span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb71-24"><a href="#cb71-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb71-25"><a href="#cb71-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb71-26"><a href="#cb71-26" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(k)</span></code></pre></div>
<pre><code>## [1] 1168</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1001</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x[b<span class="sc">:</span>m]</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">ppoints</span>(<span class="dv">20</span>)</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>QR <span class="ot">&lt;-</span> <span class="fu">qcauchy</span>(a)</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>Q <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x,a)</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(QR,Q,<span class="at">main=</span><span class="st">&quot;&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Cauchy Quantiles&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Sample Quantiles&quot;</span>)</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(y,<span class="at">breaks=</span><span class="st">&quot;scott&quot;</span>,<span class="at">main=</span><span class="st">&quot;&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>,<span class="at">freq=</span><span class="cn">FALSE</span>)</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(QR,<span class="fu">f</span>(QR,theta,eta))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAaVBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6OpA6kNtmAABmADpmkJBmtrZmtv+QOgCQ27aQ2/+2ZgC2Zjq225C2///bkDrbtmbb25Db2//b/7bb////tmb/trb/25D//7b//9v////5jCuxAAAACXBIWXMAAA7DAAAOwwHHb6hkAAALHElEQVR4nO2djXrjKBJFmXYyO+P0TGdbu+3dnWic6P0fcgUIWf8XUQWR3fd+nY4dSzI+LooCCmQaalPmswtwdBEQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQHdAL2/nJuLMae3TyzNAXUDVJ3ers9PTfX0iaU5oHpA7y/fmtq0P19+fGZ59unj1ThlLPMIUNW+0eWOAF3M2T+owwN9DarY0/vL6e395X6q2Mdrj+WSzXUOnbT55fvH6/3wcUbfKZ9jUG7mzap038epsAXlupz9Ux5ArQ/qTKiID7J17PRWyd5pGZDJFZC2RXbKGLzdCl7/8v1inbSI0JxDB+duI/a+4LZC25q82czbOOD6bFpvji43/MthAKUUYhQHWUBb7YHj8+v3UfuBipAfUL3xhU3KklCKmQVV6/XZVT/fFVlrNRYB5fNBlTHn6+9v61/YpCwSQJ0P6huGBdlidE3rxM42WnPTvb6/aFj2y6yc9cQ18zJAvknYNFZrPZcEC1p8QS5nN67KRwaKQkAxJfryw5lQvcaxMCBrzR//awpZUIxqX5FW+yNFAd1a3GlwslLlCwDaf7mcgJqLt+R61XFqAQoRqXhsZVYCs/ZCGR3fgggIXK4QoLX4n4CA9HzQuXdD9EEbVxDrgQG9f/Wxn2zwsjAgOKuRAZBsVqMsIDyroQaousVBugNmOQFFjElnsCCZpiUway9oKGJW4/BOOiugshYkmsZdHQ/KCihiVkMTUKUx91YWEJ7V0PRBsumM6eW6pyan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" /><!-- --></p>
</div>
<div id="question-9.8" class="section level2">
<h2>Question 9.8</h2>
<p>This example appears in [40]. Consider the bivariate density</p>
<p>It can be shown (see e.g. [23]) that for fixed a, b, n, the conditional distributions are Binomial(n, y) and Beta(x + a, n − x + b). Use the Gibbs sampler to generate a chain with target joint density f(x, y).</p>
</div>
<div id="answer-9.8" class="section level2">
<h2>Answer 9.8</h2>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>)</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>,<span class="dv">2</span>]</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>  X[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, x2)</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> X[i,<span class="dv">1</span>]</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>  canshu1 <span class="ot">&lt;-</span> x1<span class="sc">+</span>a</span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>  canshu2 <span class="ot">&lt;-</span> n<span class="sc">-</span>x1<span class="sc">+</span>b</span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>  X[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,canshu1,canshu2)</span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> burn<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> X[b<span class="sc">:</span>N, ]</span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a>shuchu <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(x)</span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(shuchu)</span></code></pre></div>
<pre><code>## [1] 9.7125000 0.6448519</code></pre>
</div>
<div id="answer-3-9.8" class="section level2">
<h2>Answer 3-9.8</h2>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>  psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi)</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means)</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>  psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi,<span class="dv">1</span>,<span class="st">&quot;var&quot;</span>)</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w)</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n<span class="sc">+</span>(B<span class="sc">/</span>n)</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a><span class="co">#关于原函数</span></span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>fxy <span class="ot">&lt;-</span> <span class="cf">function</span>(n1,n2,N){</span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>)</span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a>  X[,<span class="dv">1</span>] <span class="ot">&lt;-</span> n1</span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a>  X[,<span class="dv">2</span>] <span class="ot">&lt;-</span> n2</span>
<span id="cb76-23"><a href="#cb76-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb76-24"><a href="#cb76-24" aria-hidden="true" tabindex="-1"></a>    x2 <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>,<span class="dv">2</span>]</span>
<span id="cb76-25"><a href="#cb76-25" aria-hidden="true" tabindex="-1"></a>    X[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, x2)</span>
<span id="cb76-26"><a href="#cb76-26" aria-hidden="true" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> X[i,<span class="dv">1</span>]</span>
<span id="cb76-27"><a href="#cb76-27" aria-hidden="true" tabindex="-1"></a>    canshu1 <span class="ot">&lt;-</span> x1<span class="sc">+</span>a</span>
<span id="cb76-28"><a href="#cb76-28" aria-hidden="true" tabindex="-1"></a>    canshu2 <span class="ot">&lt;-</span> n<span class="sc">-</span>x1<span class="sc">+</span>b</span>
<span id="cb76-29"><a href="#cb76-29" aria-hidden="true" tabindex="-1"></a>    X[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,canshu1,canshu2)</span>
<span id="cb76-30"><a href="#cb76-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb76-31"><a href="#cb76-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(X)</span>
<span id="cb76-32"><a href="#cb76-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb76-33"><a href="#cb76-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-34"><a href="#cb76-34" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1500</span></span>
<span id="cb76-35"><a href="#cb76-35" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb76-36"><a href="#cb76-36" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>)</span>
<span id="cb76-37"><a href="#cb76-37" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb76-38"><a href="#cb76-38" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb76-39"><a href="#cb76-39" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,k,n)</span>
<span id="cb76-40"><a href="#cb76-40" aria-hidden="true" tabindex="-1"></a>mu2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,k,n)</span>
<span id="cb76-41"><a href="#cb76-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-42"><a href="#cb76-42" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb76-43"><a href="#cb76-43" aria-hidden="true" tabindex="-1"></a>  h <span class="ot">&lt;-</span> <span class="fu">fxy</span>(n1[i],n2[i],n)</span>
<span id="cb76-44"><a href="#cb76-44" aria-hidden="true" tabindex="-1"></a>  mu1[i,] <span class="ot">&lt;-</span> h[,<span class="dv">1</span>]</span>
<span id="cb76-45"><a href="#cb76-45" aria-hidden="true" tabindex="-1"></a>  mu2[i,] <span class="ot">&lt;-</span> h[,<span class="dv">2</span>]</span>
<span id="cb76-46"><a href="#cb76-46" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb76-47"><a href="#cb76-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-48"><a href="#cb76-48" aria-hidden="true" tabindex="-1"></a>psimu1 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(mu1,<span class="dv">1</span>,cumsum))</span>
<span id="cb76-49"><a href="#cb76-49" aria-hidden="true" tabindex="-1"></a>psimu2 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(mu1,<span class="dv">1</span>,cumsum))</span></code></pre></div>
</div>
<div id="hw8-2021-11-18" class="section level2">
<h2>HW8 2021-11-18</h2>
</div>
<div id="question-11.3-11.5-3" class="section level2">
<h2>Question 11.3 11.5 3</h2>
</div>
<div id="answer-11.3" class="section level2">
<h2>Answer 11.3</h2>
<ol style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>fk <span class="ot">&lt;-</span> <span class="cf">function</span>(k,<span class="at">d=</span><span class="dv">2</span>,x,y){</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> ((<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k <span class="sc">*</span> (x<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>y<span class="sc">^</span><span class="dv">2</span>)<span class="sc">^</span>(k<span class="sc">+</span><span class="dv">1</span>) <span class="sc">*</span> <span class="fu">gamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">gamma</span>(k <span class="sc">+</span> <span class="fl">1.5</span>) <span class="sc">/</span> <span class="fu">factorial</span>(k) <span class="sc">/</span> <span class="dv">2</span><span class="sc">^</span>k <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> k<span class="sc">+</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">gamma</span>(k<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>(b)(c)</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>sum1 <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">99</span>){</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  sum1 <span class="ot">=</span> sum1 <span class="sc">+</span> <span class="fu">fk</span>(i,<span class="at">d=</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sum1)</span></code></pre></div>
<pre><code>## [1] 1.532164</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>sum2 <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">119</span>){</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  sum2 <span class="ot">=</span> sum2 <span class="sc">+</span> <span class="fu">fk</span>(i,<span class="at">d=</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sum2)</span></code></pre></div>
<pre><code>## [1] 1.532164</code></pre>
<p>前100项与前120项所得相同，说明其和已经收敛，故a=(1,2),d=2时，和为1.5321</p>
</div>
<div id="answer-11.5" class="section level2">
<h2>Answer 11.5</h2>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="cf">function</span>(a,k){</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  ck <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>k<span class="sc">/</span>(k<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pt</span>(ck,<span class="at">df=</span>k,<span class="at">lower.tail=</span><span class="cn">FALSE</span>)</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>f <span class="ot">=</span> <span class="cf">function</span>(a,k){<span class="fu">S</span>(a,k)<span class="sc">-</span><span class="fu">S</span>(a,k<span class="dv">-1</span>)}</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>solve <span class="ot">=</span> <span class="cf">function</span>(k){</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">=</span> <span class="fu">uniroot</span>(<span class="cf">function</span>(a){<span class="fu">S</span>(a,k)<span class="sc">-</span><span class="fu">S</span>(a,k<span class="dv">-1</span>)},<span class="at">lower=</span><span class="fl">0.1</span>,<span class="at">upper=</span><span class="dv">2</span>)</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>root</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(<span class="dv">100</span>)</span></code></pre></div>
<pre><code>## [1] 1.720607</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(<span class="dv">200</span>)</span></code></pre></div>
<pre><code>## [1] 1.726309</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(<span class="dv">300</span>)</span></code></pre></div>
<pre><code>## [1] 1.728221</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(<span class="dv">500</span>)</span></code></pre></div>
<pre><code>## [1] 1.729753</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(<span class="dv">1000</span>)</span></code></pre></div>
<pre><code>## [1] 1.730905</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(<span class="dv">5000</span>)</span></code></pre></div>
<pre><code>## [1] 1.731828</code></pre>
<p>随着k的增大，a的值稳定在1.73附近，与11.4所得相同</p>
</div>
<div id="answer-3-1" class="section level2">
<h2>Answer 3</h2>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.21</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">0.48</span>, <span class="fl">0.54</span>, <span class="fl">0.85</span>, <span class="fl">0.91</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>EM <span class="ot">&lt;-</span> <span class="cf">function</span>(y, <span class="at">max.it=</span><span class="dv">1000</span>, <span class="at">eps=</span><span class="fl">1e-5</span>){</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  lambda <span class="ot">=</span> <span class="fl">0.5</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>  lambda1 <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>  lambda2 <span class="ot">=</span> <span class="fl">0.5</span></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">abs</span>(lambda1<span class="sc">-</span>lambda2) <span class="sc">&gt;=</span> eps){</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>    lambda1 <span class="ot">&lt;-</span> lambda2</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>    lambda2 <span class="ot">&lt;-</span> (<span class="fu">sum</span>(y) <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> lambda2) <span class="sc">/</span> <span class="dv">10</span></span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">==</span> max.it) <span class="cf">break</span></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>    i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(lambda2)</span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a><span class="fu">EM</span>(y,<span class="at">max.it=</span><span class="dv">1000</span>,<span class="at">eps=</span><span class="fl">1e-5</span>)</span></code></pre></div>
<pre><code>## [1] 0.964283</code></pre>
</div>
<div id="hw9-2021-11-25" class="section level2">
<h2>HW9 2021-11-25</h2>
</div>
<div id="page-204-1" class="section level2">
<h2>page 204-1</h2>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>trims <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rcauchy</span>(<span class="dv">100</span>)</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 在源代码的基础上以向量矩阵输出</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(<span class="fu">lapply</span>(trims, <span class="cf">function</span>(trim) <span class="fu">mean</span>(x, <span class="at">trim =</span> trim)))</span></code></pre></div>
<pre><code>## [1] -0.4953260 -0.2090875 -0.2184209 -0.1284268</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(<span class="fu">lapply</span>(trims, mean, <span class="at">x =</span> x))</span></code></pre></div>
<pre><code>## [1] -0.4953260 -0.2090875 -0.2184209 -0.1284268</code></pre>
<p>Because the second form just calls <code>mean</code> directly with the value of its x argument assigned by <code>lapply</code> and the next argument (which is <code>trim</code> receiving the value of the current iteration element.</p>
</div>
<div id="page-204-5" class="section level2">
<h2>page 204-5</h2>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(mtcars)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>formulas <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> disp,</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>rsquared <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a><span class="co">#loops</span></span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>func_loop <span class="ot">=</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="fu">length</span>(formulas))</span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(formulas)){</span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a>  func_loop[[i]] <span class="ot">=</span> <span class="fu">lm</span>(formulas[[i]], <span class="at">data =</span> mtcars)</span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(<span class="fu">lapply</span>(func_loop,rsquared))</span></code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lapply</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>func_apply <span class="ot">&lt;-</span> <span class="fu">lapply</span>(formulas, <span class="cf">function</span>(x) <span class="fu">lm</span>(<span class="at">formula =</span> x, <span class="at">data =</span> mtcars))</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(<span class="fu">lapply</span>(func_apply,rsquared))</span></code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
</div>
<div id="page-214-1" class="section level2">
<h2>page 214-1</h2>
<p>计算数字数据框中每列的标准差</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">seq =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>),</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">math =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">80</span>,<span class="dv">3</span>),</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">90</span>,<span class="dv">1</span>)</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(x, <span class="at">FUN =</span> sd,<span class="at">FUN.VALUE =</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>##       seq      math Statistic 
##  3.027650  2.853281  1.170673</code></pre>
<p>计算混合数据框中每列的标准差</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">seq =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>),</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="fu">c</span>(<span class="st">&#39;张三&#39;</span>,<span class="st">&#39;李四&#39;</span>,<span class="st">&#39;王五&#39;</span>),</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">math =</span> <span class="fu">rnorm</span>(<span class="dv">3</span>,<span class="dv">80</span>,<span class="dv">3</span>),</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">rnorm</span>(<span class="dv">3</span>,<span class="dv">90</span>,<span class="dv">1</span>)</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(y[<span class="fu">vapply</span>(y, <span class="at">FUN =</span> is.numeric, <span class="at">FUN.VALUE =</span> <span class="fu">logical</span>(<span class="dv">1</span>))], <span class="at">FUN =</span> sd, <span class="at">FUN.VALUE =</span> <span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##       seq      math Statistic 
## 1.0000000 3.9316415 0.5285068</code></pre>
</div>
<div id="page-214-7" class="section level2">
<h2>page 214-7</h2>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>mcsapply <span class="ot">&lt;-</span> <span class="cf">function</span>(x, f, ...) {</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>  shuchu <span class="ot">&lt;-</span> <span class="fu">mclapply</span>(f, ...)</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">simplify2array</span>(shuchu)</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>mcvapply <span class="ot">&lt;-</span> <span class="cf">function</span>(x, f, FUN.VALUE, ...) {</span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>  shuchu_list <span class="ot">&lt;-</span> <span class="fu">mclapply</span>(f, ...)</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(FUN.VALUE, <span class="fu">length</span>(x)), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(x)) {</span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(</span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">length</span>(res) <span class="sc">==</span> <span class="fu">length</span>(f.value),</span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">typeof</span>(res) <span class="sc">==</span> <span class="fu">typeof</span>(f.value))</span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>    out[i, ] <span class="ot">&lt;-</span> shuchu_list[[i]]</span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a>  out</span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>mcvapply也是可以生成的，构造如上。</p>
</div>
<div id="hw10-2021-12-02" class="section level2">
<h2>HW10 2021-12-02</h2>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 用C++写</span></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5115</span>)</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a><span class="fu">sourceCpp</span>(<span class="at">code=</span><span class="st">&#39;</span></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a><span class="st">#include &lt;Rcpp.h&gt;</span></span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a><span class="st">using namespace Rcpp;</span></span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a><span class="st">//[[Rcpp::export]]</span></span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a><span class="st">  NumericMatrix method_1(int n, int a, int b, int N){</span></span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a><span class="st">    NumericMatrix shuchu(N, 2);</span></span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a><span class="st">    double x1=1;</span></span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a><span class="st">    double x2=0.66;</span></span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a><span class="st">    double canshu1=1;</span></span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a><span class="st">    double canshu2=1;</span></span>
<span id="cb109-18"><a href="#cb109-18" aria-hidden="true" tabindex="-1"></a><span class="st">    for(int i=0; i &lt; N; i++){</span></span>
<span id="cb109-19"><a href="#cb109-19" aria-hidden="true" tabindex="-1"></a><span class="st">      x1 = rbinom(1, n, x2)[0];</span></span>
<span id="cb109-20"><a href="#cb109-20" aria-hidden="true" tabindex="-1"></a><span class="st">      canshu1 = x1 + a;</span></span>
<span id="cb109-21"><a href="#cb109-21" aria-hidden="true" tabindex="-1"></a><span class="st">      canshu2 = n - x1 + b;</span></span>
<span id="cb109-22"><a href="#cb109-22" aria-hidden="true" tabindex="-1"></a><span class="st">      x2 = rbeta(1, canshu1, canshu2)[0];</span></span>
<span id="cb109-23"><a href="#cb109-23" aria-hidden="true" tabindex="-1"></a><span class="st">      shuchu(i,0) = x1;</span></span>
<span id="cb109-24"><a href="#cb109-24" aria-hidden="true" tabindex="-1"></a><span class="st">      shuchu(i,1) = x2;</span></span>
<span id="cb109-25"><a href="#cb109-25" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb109-26"><a href="#cb109-26" aria-hidden="true" tabindex="-1"></a><span class="st">    return(shuchu);</span></span>
<span id="cb109-27"><a href="#cb109-27" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb109-28"><a href="#cb109-28" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span>)</span>
<span id="cb109-29"><a href="#cb109-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-30"><a href="#cb109-30" aria-hidden="true" tabindex="-1"></a><span class="co"># 用R写</span></span>
<span id="cb109-31"><a href="#cb109-31" aria-hidden="true" tabindex="-1"></a>method_2 <span class="ot">&lt;-</span> <span class="cf">function</span>(n, a, b, N){</span>
<span id="cb109-32"><a href="#cb109-32" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>)</span>
<span id="cb109-33"><a href="#cb109-33" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb109-34"><a href="#cb109-34" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb109-35"><a href="#cb109-35" aria-hidden="true" tabindex="-1"></a>    x2 <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>,<span class="dv">2</span>]</span>
<span id="cb109-36"><a href="#cb109-36" aria-hidden="true" tabindex="-1"></a>    X[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, x2)</span>
<span id="cb109-37"><a href="#cb109-37" aria-hidden="true" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> X[i,<span class="dv">1</span>]</span>
<span id="cb109-38"><a href="#cb109-38" aria-hidden="true" tabindex="-1"></a>    canshu1 <span class="ot">&lt;-</span> x1<span class="sc">+</span>a</span>
<span id="cb109-39"><a href="#cb109-39" aria-hidden="true" tabindex="-1"></a>    canshu2 <span class="ot">&lt;-</span> n<span class="sc">-</span>x1<span class="sc">+</span>b</span>
<span id="cb109-40"><a href="#cb109-40" aria-hidden="true" tabindex="-1"></a>    X[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,canshu1,canshu2)</span>
<span id="cb109-41"><a href="#cb109-41" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb109-42"><a href="#cb109-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(X)</span>
<span id="cb109-43"><a href="#cb109-43" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb109-44"><a href="#cb109-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-45"><a href="#cb109-45" aria-hidden="true" tabindex="-1"></a><span class="co">#比较</span></span>
<span id="cb109-46"><a href="#cb109-46" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb109-47"><a href="#cb109-47" aria-hidden="true" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb109-48"><a href="#cb109-48" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb109-49"><a href="#cb109-49" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb109-50"><a href="#cb109-50" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb109-51"><a href="#cb109-51" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> burn<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb109-52"><a href="#cb109-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-53"><a href="#cb109-53" aria-hidden="true" tabindex="-1"></a>hanshu1 <span class="ot">&lt;-</span> <span class="fu">method_1</span>(n,a,b,N)[b<span class="sc">:</span>N,]</span>
<span id="cb109-54"><a href="#cb109-54" aria-hidden="true" tabindex="-1"></a>hanshu2 <span class="ot">&lt;-</span> <span class="fu">method_2</span>(n,a,b,N)[b<span class="sc">:</span>N,]</span>
<span id="cb109-55"><a href="#cb109-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-56"><a href="#cb109-56" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(hanshu1[,<span class="dv">2</span>], hanshu2[,<span class="dv">2</span>],<span class="at">xlab=</span><span class="st">&#39;r&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;c++&#39;</span>)</span>
<span id="cb109-57"><a href="#cb109-57" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>COMP <span class="ot">=</span> <span class="fu">summary</span>(<span class="fu">microbenchmark</span>(hanshu1,hanshu2))</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(COMP)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">expr</th>
<th align="right">min</th>
<th align="right">lq</th>
<th align="right">mean</th>
<th align="right">median</th>
<th align="right">uq</th>
<th align="right">max</th>
<th align="right">neval</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">hanshu1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">5.51</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">501</td>
<td align="right">100</td>
</tr>
<tr class="even">
<td align="left">hanshu2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">18.60</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1801</td>
<td align="right">100</td>
</tr>
</tbody>
</table>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
